# Supabase 프로젝트 연동

- 테이블 생성은 생략함.

```sql
CREATE TABLE todos (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title VARCHAR NOT NULL,
    completed BOOLEAN DEFAULT FALSE NOT NULL,
    content TEXT,
    updated_at TIMESTAMPTZ DEFAULT now(),
    created_at TIMESTAMPTZ DEFAULT now()
);
```

## 1. `.env` 파일 생성

- `VITE_`를 접두어로 사용

```
VITE_SUPABASE_DB_PW=데이터베이스 비밀번호
VITE_SUPABASE_URL=URL값
VITE_SUPABASE_ANON_KEY=키값
```

## 2. Supabase 클라이언트 라이브러리 설치

```bash
npm install @supabase/supabase-js
```

## 3. 폴더 및 파일 구조

- `/src/lib` 폴더 생성
- `/src/lib/supabase.ts` 파일 생성

```ts
import { createClient } from '@supabase/supabase-js';

// CRA 의 환경변수 호출과는 형식이 다름.
const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Missing Supabase environment variables');
}

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
```

## 4. Supabase 의 테이블의 칼럼의 데이터 타입 정의

### 4.1. 데이터 타입 쉽게 추출하기

```bash
npx supabase login
```

- 향후 지시하는대로 실행함.
- id 는 URL 의 앞쪽 단어가 ID가 됨.
- package.json 수정

```json
"scripts": {
  ...
    "generate-types": "npx supabase gen types typescript --project-id 프로젝트명 --schema public > types_db.ts"
  },
```

## 5. CRUD 실행해보기

### 5.1. CRUD 를 위한 폴더 및 파일 구조

- `/src/apis` 폴더 생성 또는 `/src/services` 폴더 생성

- 예) `/src/services` 폴더 로 진행
- /src/services/todoService.ts 파일 생성